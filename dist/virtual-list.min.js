var VirtualList=function(e){"use strict";function t(e,t,i,n,r,s,a){try{var o=e[s](a),l=o.value}catch(e){return void i(e)}o.done?t(l):Promise.resolve(l).then(n,r)}function i(e){return function(){var i=this,n=arguments;return new Promise((function(r,s){var a=e.apply(i,n);function o(e){t(a,r,s,o,l,"next",e)}function l(e){t(a,r,s,o,l,"throw",e)}o(void 0)}))}}function n(e,t,i){var n,r,s,a,o;function l(){var c=Date.now()-a;c<t&&c>=0?n=setTimeout(l,t-c):(n=null,i||(o=e.apply(s,r),s=r=null))}null==t&&(t=100);var c=function(){s=this,r=arguments,a=Date.now();var c=i&&!n;return n||(n=setTimeout(l,t)),c&&(o=e.apply(s,r),s=r=null),o};return c.clear=function(){n&&(clearTimeout(n),n=null)},c.flush=function(){n&&(o=e.apply(s,r),s=r=null,clearTimeout(n),n=null)},c}n.debounce=n;var r=n;function s(e){var t=e&&e.parentNode;return t&&t!==document.body?function(e){var t=/(auto|scroll)/;function i(e,t){getComputedStyle(e,null).getPropertyValue(t)}return t.test(i(e,"overflow"))||t.test(i(e,"overflow-x"))||t.test(i(e,"overflow-y"))}(t)?t:s(t):document.body}var a=0;function o(e,t,i,n,r,s,a,o,l,c){"boolean"!=typeof a&&(l=o,o=a,a=!1);const h="function"==typeof i?i.options:i;let u;if(e&&e.render&&(h.render=e.render,h.staticRenderFns=e.staticRenderFns,h._compiled=!0,r&&(h.functional=!0)),n&&(h._scopeId=n),s?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},h._ssrRegister=u):t&&(u=a?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,o(e))}),u)if(h.functional){const e=h.render;h.render=function(t,i){return u.call(i),e(t,i)}}else{const e=h.beforeCreate;h.beforeCreate=e?[].concat(e,u):[u]}return i}const l={props:{items:{type:Array,default:function(){return[]}},keyField:{type:String,default:"id"},prerender:{type:Number,default:0},itemSize:{type:Number,default:null},buffer:{type:Number,default:10},typeField:{type:String,default:"type"}},data:function(){return{scrollableParent:null,totalHeight:0,ready:!1,pool:[],sizeCache:new Map,views:new Map,unusedViews:new Map,averageItemSize:0,minItemSize:0,anchorItem:{index:0,offset:0},firstAttachedItem:0,lastAttachedItem:0,anchorScrollTop:0}},watch:{items:function(){this.updateVisibleItems(!0)}},created:function(){this.$_scrollDirty=!1,this.$_window_width=null,this.debouncedUpdatePositions=r.debounce(this.updateItemsPosition,100),this.prerender&&(this.$_prerender=!0,this.updateVisibleItems(!1))},mounted:function(){this.$_window_width=window.innerWidth,this.init()},beforeDestroy:function(){this.removeEventListeners()},methods:{getFirstScrollableParent:function(){return s(this.$el)},init:function(){var e=this.getFirstScrollableParent();e!==document.body&&(this.scrollableParent=e),this.addEventListeners(),this.$_prerender=!1,this.updateVisibleItems(!0),this.ready=!0},addEventListeners:function(){this.scrollableParent?this.scrollableParent.addEventListener("scroll",this.onScroll):window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onResize)},removeEventListeners:function(){this.scrollableParent?this.scrollableParent.removeEventListener("scroll",this.onScroll):window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onResize)},onScroll:function(){var e=this;this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame((function(){e.$_scrollDirty=!1,e.updateVisibleItems(!1,!0).continuous||(clearTimeout(e.$_refreshTimout),e.$_refreshTimout=setTimeout(e.handleScroll,100))})))},onResize:function(){this.$_window_width!==window.innerWidth&&(this.clearSizeCache(),this.ready&&this.updateVisibleItems(!1))},clearSizeCache:function(){this.averageItemSize=null,this.minItemSize=null,this.sizeCache.clear()},calculateAnchoredItem:function(e,t){var i=this.keyField;if(0===t)return e;t+=e.offset;var n=e.index;if(t<0)for(;t<0&&n>0;){var r=i?this.items[n-1][i]:this.items[n-1];t+=this.sizeCache.get(r)||this.averageItemSize,n--}else for(;t>0&&n<this.items.length-1;){var s=i?this.items[n+1][i]:this.items[n+1];t-=this.sizeCache.get(s)||this.averageItemSize,n++}return{index:n,offset:t}},updateVisibleItems:function(e){var t=arguments,n=this;return i(regeneratorRuntime.mark((function i(){var r,s,a,o,l,c,h,u,d,f,m,v,p,I,w,g,y,b,S,z,x,_,C,A,k,V,$;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(r=t.length>1&&void 0!==t[1]&&t[1],s=n.items,a=s.length,o=n.itemSize,l=n.minItemSize,c=n.averageItemSize,h=n.buffer,u=n.views,d=n.unusedViews,f=n.keyField,m=n.typeField,v=n.pool,p=n.firstAttachedItem,I=n.lastAttachedItem,a){i.next=21;break}return n.firstAttachedItem=0,n.lastAttachedItem=0,n.totalHeight=0,i.abrupt("return");case 21:if(!n.$_prerender){i.next=28;break}return n.firstAttachedItem=0,n.lastAttachedItem=n.prerender,n.totalHeight=null,i.abrupt("return");case 28:if(o||l&&c){i.next=32;break}n.lastAttachedItem=n.firstAttachedItem+20,i.next=44;break;case 32:if(w=n.getScroll(),g=w.start-n.anchorScrollTop,!r){i.next=39;break}if((y=g)<0&&(y=-y),!(null===o&&y<l||y<o)){i.next=39;break}return i.abrupt("return",{continuous:!0});case 39:0===w.start?n.anchorItem={index:0,offset:0}:n.anchorItem=n.calculateAnchoredItem(n.anchorItem,g),n.anchorScrollTop=w.start,b=n.calculateAnchoredItem(n.anchorItem,w.end),n.firstAttachedItem=Math.max(0,n.anchorItem.index-h),n.lastAttachedItem=Math.min(n.items.length,b.index+h);case 44:S=n.firstAttachedItem<=I&&n.lastAttachedItem>=p,n.continuous!==S?(S&&(u.clear(),d.clear(),n.pool.forEach((function(e){n.unuseView(e)}))),n.continuous=S):S&&n.pool.forEach((function(t){t.nr.used&&(e&&(t.nr.index=s.findIndex((function(e){return n.keyField?e[f]===t.item[f]:e===t.item}))),(-1===t.nr.index||t.nr.index<n.firstAttachedItem||t.nr.index>=n.lastAttachedItem)&&n.unuseView(t))})),z=S?null:new Map,V=n.firstAttachedItem;case 48:if(!(V<n.lastAttachedItem)){i.next=58;break}if(x=s[V],null!=($=f?x[f]:x)){i.next=53;break}throw new Error("Key is ".concat($," on item (keyField is '").concat(f,"')"));case 53:(k=u.get($))?(k.nr.used=!0,k.item=x):(_=x[m],C=d.get(_),S?C&&C.length?((k=C.pop()).item=x,k.nr.used=!0,k.nr.index=V,k.nr.key=$,k.nr.type=_):k=n.addView(v,V,x,$,_):(A=z.get(_)||0,(!C||A>=C.length)&&(k=n.addView(v,V,x,$,_),n.unuseView(k,!0),C=d.get(_)),(k=C[A]).item=x,k.nr.used=!0,k.nr.index=V,k.nr.key=$,k.nr.type=_,z.set(_,A+1),A++),u.set($,k));case 55:V++,i.next=48;break;case 58:return i.next=60,n.$nextTick();case 60:n.measureItems(),n.totalHeight=n.calculateTotalHeight(),n.fixScrollPosition(),n.debouncedUpdatePositions();case 64:case"end":return i.stop()}}),i)})))()},getScroll:function(){var e,t=this.$el;if(this.scrollableParent)e={start:this.scrollableParent.scrollTop,end:this.scrollableParent.scrollTop+this.scrollableParent.clientHeight};else{var i=t.getBoundingClientRect(),n=i.height,r=-i.top,s=window.innerHeight;r<0&&(s+=r,r=0),r+s>n&&(s=n-r),e={start:r,end:r+s}}return e},calculateTotalHeight:function(){if(this.itemSize)return this.itemSize*this.items.length;var e=0,t=this.sizeCache.size,i=this.items.length-t;return e+=i*this.averageItemSize,this.sizeCache.forEach((function(t){e+=t})),e},unuseView:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.unusedViews,n=e.nr.type,r=i.get(n);r||(r=[],i.set(n,r)),r.push(e),t||(e.nr.used=!1,e.position=-9999,this.views.delete(e.nr.key))},addView:function(e,t,i,n,r){var s={item:i,position:0},o={id:a++,index:t,used:!0,key:n,type:r};return Object.defineProperty(s,"nr",{configurable:!1,value:o}),e.push(s),s},measureItems:function(){var e=this,t=this.$refs.listviewItem,i=!1;if(t.forEach((function(t,n){var r=e.pool[n];if(r.nr.used){var s=t.offsetHeight,a=r.nr.key;e.sizeCache.has(a)&&e.sizeCache.get(a)===s||(i=!0,e.sizeCache.set(a,s))}})),i){var n=this.sizeCache.size,r=null,s=0;this.sizeCache.forEach((function(e){r=null===r?e:Math.min(e,r),s+=e}));var a=s/n;this.minItemSize=r,this.averageItemSize=a}},fixScrollPosition:function(){for(var e=0,t=0;t<this.anchorItem.index;t++){var i=this.keyField,n=i?this.items[t][i]:this.items[t];e+=this.sizeCache.get(n)||this.averageItemSize||0}e+=this.anchorItem.offset,this.anchorScrollTop=e},updateItemsPosition:function(){for(var e=this.keyField,t=this.anchorScrollTop-this.anchorItem.offset,i=this.anchorItem.index;i>this.firstAttachedItem;){var n=e?this.items[i-1][e]:this.items[i-1];t-=this.sizeCache.get(n)||this.averageItemSize||0,i--}for(;i<this.firstAttachedItem;){var r=e?this.items[i][e]:this.items[i];t+=this.sizeCache.get(r)||this.averageItemSize||0,i++}for(var s=this.firstAttachedItem;s<this.lastAttachedItem;s++){var a=e?this.items[s][e]:this.items[s];this.views.get(a).position=t,t+=this.sizeCache.get(a)||this.averageItemSize||0}}}};var c=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"listview",class:{ready:e.ready},style:{height:e.totalHeight+"px"}},e._l(e.pool,(function(t){return i("div",{key:t.nr.id,ref:"listviewItem",refInFor:!0,staticClass:"listview__item",style:e.ready?{transform:"translateY("+t.position+"px)"}:null},[e._t("default",null,{item:t.item,index:t.nr.index,active:t.nr.used})],2)})),0)};c._withStripped=!0;const h=o({render:c,staticRenderFns:[]},void 0,l,"data-v-a8581048",!1,void 0,!1,void 0,void 0,void 0);function u(e){u.installed||(u.installed=!0,e.component("ListView",h))}var d={install:u},f=null;return"undefined"!=typeof window?f=window.Vue:"undefined"!=typeof global&&(f=global.Vue),f&&f.use(d),e.default=h,e.install=u,e}({});
//# sourceMappingURL=virtual-list.min.js.map
